import{Eb as Oe,Ha as ge,Ib as we,Jb as Ie,La as he,Lb as ke,Ma as _e,Mb as Te,Nb as Fe,Oa as Ce,Ob as Ae,Pb as Ee,Qa as fe,Qb as $e,Ra as ve,Sb as Ve,Ub as Be,Yb as De,Zb as W,bb as be,gb as Se,hb as Pe,ib as Me,jb as ye,kb as xe,o as me,q as ue}from"./chunk-MWVRVSUL.js";import{$b as X,H as S,Hb as r,Ib as l,Ic as ie,Jb as V,Kb as j,Lb as z,Nb as M,Qb as C,Sb as m,U as N,V as x,Wb as I,X as $,Xb as k,Yb as T,_a as Z,ab as a,ac as d,bb as P,bc as y,cc as B,cd as oe,dd as re,ed as se,f as U,fc as L,fd as ae,gc as K,gd as le,h as q,hc as H,ja as Y,jc as ee,jd as ce,kc as F,kd as pe,l as G,mc as te,nd as de,pc as h,qc as _,r as E,rc as Q,s as J,sb as v,ta as u,tc as ne,ua as g,xb as c,zb as O}from"./chunk-IJHYSKBE.js";import{g as R}from"./chunk-TSRGIXR5.js";var Ne=["fileInput"],je=["folderInput"],ze=["messageContainer"],Le=["promptsPopup"],D=()=>[],Ke=(s,t)=>({"user-message":s,"ai-message":t});function He(s,t){if(s&1){let e=M();j(0),r(1,"p",36),d(2),l(),r(3,"span",37),d(4),h(5,"date"),l(),r(6,"mat-icon",38),C("click",function(i){u(e);let o=m().$implicit;return m().startEditing(o),g(i.stopPropagation())}),d(7,"edit"),l(),z()}if(s&2){let e=m().$implicit;a(2),y(e.Title),a(2),y(Q(5,2,e.CreatedAt,"short"))}}function Qe(s,t){if(s&1){let e=M();r(0,"div",39)(1,"input",40),H("ngModelChange",function(i){u(e);let o=m(2);return K(o.editedTitle,i)||(o.editedTitle=i),g(i)}),C("input",function(){u(e);let i=m(2);return g(i.onTitleInput())})("keyup.enter",function(){u(e);let i=m(2);return g(i.saveTitle())}),l(),r(2,"div",41)(3,"button",42),C("click",function(i){return u(e),m(2).saveTitle(),g(i.stopPropagation())}),r(4,"mat-icon"),d(5,"check"),l()(),r(6,"button",43),C("click",function(i){return u(e),m(2).cancelEditing(),g(i.stopPropagation())}),r(7,"mat-icon"),d(8,"close"),l()()()()}if(s&2){let e=m(2);a(),L("ngModel",e.editedTitle)}}function We(s,t){if(s&1){let e=M();r(0,"div",32),h(1,"async"),C("click",function(){let i=u(e).$implicit,o=m();return g(o.selectConversation(i.Id))}),r(2,"div",33),v(3,He,8,5,"ng-container",34)(4,Qe,9,1,"ng-template",null,3,ne),l(),r(6,"p",35),d(7),l()()}if(s&2){let e,n=t.$implicit,i=X(5),o=m();O("active",((e=_(1,5,o.currentConversation$))==null?null:e.Id)===n.Id),a(3),c("ngIf",o.editingConversationId!==n.Id)("ngIfElse",i),a(4),y(n.ConversationSummary)}}function qe(s,t){if(s&1&&(r(0,"li"),d(1),l()),s&2){let e=t.$implicit;a(),B(" ",e.promptName," ")}}function Ge(s,t){s&1&&(r(0,"div",47)(1,"p"),d(2,"Mason will analyze the files you have attached to this chat using these selected prompts"),l()())}function Je(s,t){if(s&1&&(r(0,"div",44)(1,"h2"),d(2,"Selected Prompts"),l(),r(3,"ul"),v(4,qe,2,1,"li",45),h(5,"async"),h(6,"async"),h(7,"selectedPrompts"),l(),v(8,Ge,3,0,"div",46),h(9,"async"),h(10,"async"),l()),s&2){let e,n=m();a(4),c("ngForOf",Q(7,6,_(5,2,n.prompts$),_(6,4,n.selectedPrompts$))),a(4),c("ngIf",_(9,9,n.hasDocuments$)&&((e=_(10,11,n.selectedPrompts$))!==null&&e!==void 0?e:F(13,D)).length>0)}}function Ye(s,t){if(s&1&&V(0,"markdown",55),s&2){let e=m().$implicit,n=m();c("data",n.getDisplayContent(e.Content,"model"))}}function Ze(s,t){if(s&1&&(r(0,"pre",56),d(1),l()),s&2){let e=m().$implicit,n=m();a(),y(n.getDisplayContent(e.Content,"user"))}}function Xe(s,t){if(s&1){let e=M();r(0,"div",57)(1,"span"),d(2,"Failed to send message to Mason - please try again"),l(),r(3,"button",58),C("click",function(){u(e);let i=m().$implicit,o=m();return g(o.retryMessage(i))}),r(4,"mat-icon"),d(5,"refresh"),l()()()}}function et(s,t){if(s&1&&(r(0,"div",48)(1,"mat-icon",49),d(2),l(),r(3,"div",50),j(4,51),v(5,Ye,1,1,"markdown",52)(6,Ze,2,1,"pre",53),z(),v(7,Xe,6,0,"div",54),l()()),s&2){let e=t.$implicit;c("ngClass",te(6,Ke,e.Role==="user",e.Role==="model")),a(2),y(e.Role==="user"?"person":"smart_toy"),a(2),c("ngSwitch",e.Role),a(),c("ngSwitchCase","model"),a(),c("ngSwitchCase","user"),a(),c("ngIf",e.status==="failed")}}function tt(s,t){s&1&&(r(0,"div",59)(1,"p"),d(2,"Thinking..."),l()())}function nt(s,t){if(s&1&&(r(0,"div",60)(1,"p"),d(2),l(),V(3,"mat-progress-bar",61),l()),s&2){let e=m();a(2),B("Upload Progress: ",e.progress,"%"),a(),c("value",e.progress)}}function it(s,t){if(s&1&&(r(0,"div",62)(1,"p",63),d(2),l()()),s&2){let e=m();a(),c("matTooltip",e.getUploadedFileNames()),a(),B(" ",e.uploadedFileInfos.length," file(s) uploaded successfully ")}}function ot(s,t){if(s&1){let e=M();r(0,"button",68),C("click",function(){u(e);let i=m(2);return g(i.confirmPrompts())}),d(1,"Confirm"),l()}}function rt(s,t){if(s&1){let e=M();r(0,"button",69),C("click",function(){u(e);let i=m(2);return g(i.clearPrompts())}),d(1,"Clear"),l()}}function st(s,t){if(s&1){let e=M();r(0,"div",70),h(1,"async"),C("click",function(){let i=u(e).$implicit,o=m(2);return g(o.togglePromptSelection(i.id))}),r(2,"div",71),V(3,"input",72),h(4,"async"),r(5,"div",73),d(6),l(),r(7,"div",74),d(8),l()()()}if(s&2){let e,n,i=t.$implicit,o=m(2);O("disabled",((e=_(1,6,o.selectedPrompts$))==null?null:e.includes(o.fullBlueprintAnalysisPromptId))&&i.id!==o.fullBlueprintAnalysisPromptId),a(3),c("checked",o.promptSelectionState[i.id])("disabled",((n=_(4,8,o.selectedPrompts$))==null?null:n.includes(o.fullBlueprintAnalysisPromptId))&&i.id!==o.fullBlueprintAnalysisPromptId),a(3),y(i.promptName),a(2),y(i.description)}}function at(s,t){if(s&1&&(r(0,"div",64,4),v(2,ot,2,0,"button",65),h(3,"async"),v(4,rt,2,0,"button",66),h(5,"async"),v(6,st,9,10,"div",67),h(7,"async"),l()),s&2){let e,n,i=m();a(2),c("ngIf",((e=_(3,3,i.selectedPrompts$))!==null&&e!==void 0?e:F(9,D)).length>0),a(2),c("ngIf",((n=_(5,5,i.selectedPrompts$))!==null&&n!==void 0?n:F(10,D)).length>0),a(2),c("ngForOf",_(7,7,i.prompts$))}}var A=class s{constructor(t,e,n,i,o,p,f,b){this.aiChatStateService=t;this.aiChatService=e;this.route=n;this.router=i;this.fileUploadService=o;this.snackBar=p;this.cdRef=f;this.signalrService=b;this.conversations$=this.aiChatStateService.conversations$,this.messages$=this.aiChatStateService.messages$,this.isLoading$=this.aiChatStateService.isLoading$,this.selectedPrompts$=this.aiChatStateService.selectedPrompts$,this.aiChatStateService.prompts$.pipe(x(this.destroy$),$(w=>{this.promptsSource.next(w)})).subscribe(),this.currentConversation$=J([this.aiChatStateService.conversations$,this.aiChatStateService.activeConversationId$]).pipe(E(([w,Re])=>w.find(Ue=>Ue.Id===Re)||null))}fileInput;folderInput;messageContainer;destroy$=new U;promptsSource=new q(1);conversationId=null;promptsPopup;selectConversation$=new U;conversations$;messages$;currentConversation$;isLoading$;prompts$=this.promptsSource.asObservable();selectedPrompts$;hasDocuments$=G(!1);newMessageContent="";files=[];uploadedFileInfos=[];isUploading=!1;progress=0;editingConversationId=null;editedTitle="";isPromptsPopupVisible=!1;documents=[];sortOrder="desc";promptSelectionState={};fullBlueprintAnalysisPromptId=null;fullBlueprintAnalysisPromptKey="SYSTEM_COMPREHENSIVE_ANALYSIS";get isSendDisabled(){let t=[];this.selectedPrompts$.pipe(S(1)).subscribe(p=>t=p);let e=!1;this.hasDocuments$.pipe(S(1)).subscribe(p=>e=p);let n=this.newMessageContent.trim().length>0,i=this.files.length>0,o=t.length>0;return!(n||(i||e)&&o)}get isInputDisabled(){let t=[];return this.selectedPrompts$.pipe(S(1)).subscribe(e=>t=e),t.length>0}ngOnInit(){this.hasDocuments$=this.aiChatStateService.documents$.pipe(E(t=>t.length>0)),this.signalrService.startConnection(),this.aiChatService.getMyConversations(),this.aiChatService.getMyPrompts(),this.setupConversationSelection(),this.prompts$.pipe(x(this.destroy$),N(t=>this.selectedPrompts$.pipe(E(e=>({allPrompts:t,selectedPrompts:e}))))).subscribe(({allPrompts:t,selectedPrompts:e})=>{let n=t.find(i=>i.promptKey===this.fullBlueprintAnalysisPromptKey);n&&(this.fullBlueprintAnalysisPromptId=n.id),this.promptSelectionState=t.reduce((i,o)=>(i[o.id]=e.includes(o.id),i),{})}),this.route.params.pipe(x(this.destroy$)).subscribe(t=>{let e=t.conversationId;e==="new"?this.startNewConversation():e&&this.selectConversation(e)}),this.aiChatStateService.documents$.pipe(x(this.destroy$)).subscribe(t=>this.documents=t),this.aiChatStateService.currentConversation$.pipe(x(this.destroy$)).subscribe(t=>R(this,null,function*(){t&&t.Id?(this.conversationId=t.Id,yield this.signalrService.joinConversationGroup(this.conversationId)):this.conversationId=null})),this.messages$.pipe(x(this.destroy$)).subscribe(()=>{this.scrollToBottom()})}ngOnDestroy(){this.signalrService.stopConnection(),this.destroy$.next(),this.destroy$.complete()}scrollToBottom(t="auto"){setTimeout(()=>{try{this.messageContainer.nativeElement.scrollTo({top:this.messageContainer.nativeElement.scrollHeight,behavior:t})}catch{}},0)}selectConversation(t){this.router.navigate(["/ai-chat",t]),this.selectConversation$.next(t)}setupConversationSelection(){this.selectConversation$.pipe($(t=>{this.aiChatStateService.setActiveConversationId(t),this.scrollToBottom("auto")}),N(t=>this.aiChatService.getConversation(t).pipe($(()=>R(this,null,function*(){yield this.signalrService.joinConversationGroup(t)})))),x(this.destroy$)).subscribe()}get sortIcon(){return this.sortOrder==="asc"?"arrow_upward":"arrow_downward"}sortConversations(){this.sortOrder=this.sortOrder==="asc"?"desc":"asc",this.aiChatStateService.sortConversations(this.sortOrder)}startNewConversation(){this.router.navigate(["/ai-chat","new"]),this.newMessageContent="",this.aiChatStateService.setActiveConversationId(null),this.aiChatStateService.setMessages([]),this.aiChatStateService.setDocuments([]),this.aiChatService.getMyPrompts(),this.aiChatStateService.setLoading(!1)}onAttachFile(){this.fileUploadService.openUploadOptionsDialog().subscribe(t=>{t==="files"?this.fileInput.nativeElement.click():t==="folder"&&this.folderInput.nativeElement.click()})}sendMessage(){if(this.isSendDisabled)return;!(this.newMessageContent.trim().length>0)&&this.files.length===0&&this.documents.length===0&&this.selectedPrompts$.pipe(S(1)).subscribe(i=>{if(i.length===0){this.snackBar.open("Please type a message, upload a file, or select a prompt.","Close",{duration:3e3});return}});let e=this.newMessageContent,n=this.aiChatStateService.getCurrentConversationId();this.selectedPrompts$.pipe(S(1)).subscribe(i=>{this.prompts$.pipe(S(1)).subscribe(o=>{let p=i.map(f=>o.find(b=>b.id===f)?.promptKey).filter(f=>!!f);if(n){let f=this.documents.map(b=>b.blobUrl);this.aiChatService.sendMessage(n,e,this.files,p,f)}else this.aiChatService.startConversation(e,p.length>0?p[0]:null,this.files,p).subscribe(f=>{f&&this.router.navigate(["/ai-chat",f.Id])})})}),this.newMessageContent="",this.files=[],this.aiChatStateService.setSelectedPrompts([]),this.isPromptsPopupVisible=!1,this.scrollToBottom()}onKeyDown(t){t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),this.sendMessage())}getDisplayContent(t,e){return this.aiChatService.getDisplayContent(t,e)}onFileSelected(t,e){let n=t.target.files;n.length>0&&(this.files=Array.from(n),this.uploadFiles(this.files))}uploadFiles(t){this.isUploading=!0,this.progress=0;let e=i=>{this.fileUploadService.uploadFiles(t,i,i).subscribe({next:o=>{if(this.progress=o.progress,this.isUploading=o.isUploading,!o.isUploading&&o.files){this.uploadedFileInfos=[...this.uploadedFileInfos,...o.files],this.snackBar.open("Files uploaded successfully!","Close",{duration:3e3});let p=this.aiChatStateService.getCurrentConversationId();p&&this.aiChatService.getConversationDocuments(p).subscribe(f=>{this.documents=f,this.aiChatStateService.setDocuments(f),this.cdRef.detectChanges()})}},error:o=>{this.isUploading=!1,this.snackBar.open("File upload failed. Please try again.","Close",{duration:3e3}),console.error("Upload error:",o)}})},n=this.aiChatStateService.getCurrentConversationId();n?e(n):this.aiChatService.createConversation().subscribe(i=>{i&&i.Id?(this.aiChatStateService.addConversation(i),this.router.navigate(["/ai-chat",i.Id]),this.aiChatStateService.setActiveConversationId(i.Id),this.aiChatStateService.setMessages(i.messages??[]),this.conversationId=i.Id,e(i.Id)):(this.isUploading=!1,this.snackBar.open("Could not start a new conversation to upload files.","Close",{duration:3e3}))})}logDisplayName(t){return!0}getUploadedFileNames(){return this.fileUploadService.getUploadedFileNames(this.uploadedFileInfos)}viewUploadedFiles(){this.conversationId?this.aiChatService.getConversationDocuments(this.conversationId).subscribe(t=>{this.fileUploadService.viewUploadedFiles(t)}):this.fileUploadService.viewUploadedFiles(this.documents)}startEditing(t){this.editingConversationId=t.Id,this.editedTitle=t.Title}saveTitle(){if(!this.editingConversationId)return;let t=this.editedTitle?this.editedTitle.trim():"";if(t.length===0){this.snackBar.open("Title cannot be empty.","Close",{duration:3e3});return}this.editedTitle=t;let e=this.aiChatStateService.getConversationById(this.editingConversationId);if(e&&e.Title===this.editedTitle){this.cancelEditing();return}this.aiChatService.updateConversationTitle(this.editingConversationId,this.editedTitle).subscribe({next:()=>{this.aiChatStateService.updateConversationTitle(this.editingConversationId,this.editedTitle),this.cancelEditing()},error:n=>{console.error("Error updating title:",n),this.snackBar.open("Failed to update title. Please try again.","Close",{duration:3e3})}})}cancelEditing(){this.editingConversationId=null,this.editedTitle=""}onTitleInput(){let e=this.editedTitle,n="";e.length>50&&(e=e.substring(0,50),n="Title cannot exceed 50 characters.");let i=/[^a-zA-Z0-9\s]/g;i.test(e)&&(e=e.replace(i,""),n="Title can only contain letters, numbers, and spaces."),n&&this.snackBar.open(n,"Close",{duration:3e3}),this.editedTitle!==e&&(this.editedTitle=e)}autoResize(t){let e=t.target;e.style.height="auto",e.style.height=`${e.scrollHeight}px`}togglePromptsPopup(){this.isPromptsPopupVisible=!this.isPromptsPopupVisible,this.cdRef.detectChanges()}onDocumentClick(t){this.isPromptsPopupVisible&&this.promptsPopup&&!this.promptsPopup.nativeElement.contains(t.target)&&(t.target.closest(".more-options-btn")||(this.isPromptsPopupVisible=!1))}confirmPrompts(){this.isPromptsPopupVisible=!1}togglePromptSelection(t){this.prompts$.pipe(S(1)).subscribe(e=>{let n=e.find(o=>o.id===t);if(!n)return;let i=e.find(o=>o.promptKey===this.fullBlueprintAnalysisPromptKey);this.selectedPrompts$.pipe(S(1)).subscribe(o=>{let p=o.includes(t),f;if(n.promptKey===this.fullBlueprintAnalysisPromptKey)f=p?[]:[t];else if(p)f=o.filter(b=>b!==t);else{let b=o;i&&(b=b.filter(w=>w!==i.id)),f=[...b,t]}this.aiChatStateService.setSelectedPrompts(f)})})}clearPrompts(){this.aiChatStateService.setSelectedPrompts([])}retryMessage(t){this.aiChatStateService.deleteMessage(t.Id),t.ConversationId?this.aiChatService.sendMessage(t.ConversationId,t.Content,[]):this.aiChatService.startConversation(t.Content,null,[]).subscribe(e=>{e&&(this.aiChatStateService.addConversation(e),this.aiChatStateService.setActiveConversationId(e.Id),this.aiChatStateService.setMessages(e.messages??[]))})}static \u0275fac=function(e){return new(e||s)(P(Oe),P($e),P(me),P(ue),P(Be),P(Ve),P(ie),P(De))};static \u0275cmp=Y({type:s,selectors:[["app-ai-chat-full-screen"]],viewQuery:function(e,n){if(e&1&&(I(Ne,5),I(je,5),I(ze,5),I(Le,5)),e&2){let i;k(i=T())&&(n.fileInput=i.first),k(i=T())&&(n.folderInput=i.first),k(i=T())&&(n.messageContainer=i.first),k(i=T())&&(n.promptsPopup=i.first)}},hostBindings:function(e,n){e&1&&C("click",function(o){return n.onDocumentClick(o)},!1,Z)},standalone:!0,features:[ee],decls:52,vars:44,consts:[["messageContainer",""],["fileInput",""],["folderInput",""],["editMode",""],["promptsPopup",""],[1,"full-screen-chat-container"],[1,"conversations-list"],[1,"conversation-list-header"],["mat-raised-button","","color","primary",1,"new-chat-btn","submit-btn","publish-btn",3,"click"],["aria-label","Sort conversations",1,"action-btn",3,"click"],[1,"material-icons"],[1,"conversation-items"],["class","conversation-item",3,"active","click",4,"ngFor","ngForOf"],[1,"chat-area"],[1,"scroll-wrapper"],[1,"chat-window-container"],["class","selected-prompt-display",4,"ngIf"],[1,"message-history"],["class","message",3,"ngClass",4,"ngFor","ngForOf"],["class","message ai",4,"ngIf"],[1,"message-input-container"],["class","upload-progress",4,"ngIf"],["class","upload-complete",4,"ngIf"],[3,"ngSubmit"],["type","button","mat-icon-button","","matTooltip","More options",1,"more-options-btn",3,"click"],["id","chat-input","name","newMessageContent","placeholder","Type your message...","autocomplete","off","rows","1",3,"ngModelChange","input","keydown","ngModel","disabled","matTooltip"],[1,"button-wrapper",3,"matTooltip"],["mat-raised-button","","color","primary","type","submit",1,"submit-btn","publish-btn","send-button",3,"disabled"],["mat-raised-button","","type","button",1,"action-btn","submit-btn","publish-btn","icon-button",3,"click","disabled"],["type","file","multiple","",2,"display","none",3,"change"],["type","file","webkitdirectory","","multiple","",2,"display","none",3,"change"],["class","prompts-popup",4,"ngIf"],[1,"conversation-item",3,"click"],[1,"conversation-title-container"],[4,"ngIf","ngIfElse"],[1,"conversation-excerpt"],[1,"conversation-title"],[1,"conversation-timestamp"],[1,"edit-icon",3,"click"],[1,"edit-container"],["type","text",1,"edit-input",3,"ngModelChange","input","keyup.enter","ngModel"],[1,"edit-actions"],["mat-icon-button","",1,"save-button",3,"click"],["mat-icon-button","",1,"cancel-button",3,"click"],[1,"selected-prompt-display"],[4,"ngFor","ngForOf"],["class","file-analysis-notification",4,"ngIf"],[1,"file-analysis-notification"],[1,"message",3,"ngClass"],[1,"chat-icon"],[1,"message-content"],[3,"ngSwitch"],[3,"data",4,"ngSwitchCase"],["class","user-prompt",4,"ngSwitchCase"],["class","error-message",4,"ngIf"],[3,"data"],[1,"user-prompt"],[1,"error-message"],["mat-icon-button","",3,"click"],[1,"message","ai"],[1,"upload-progress"],["mode","determinate",3,"value"],[1,"upload-complete"],["matTooltipPosition","above",3,"matTooltip"],[1,"prompts-popup"],["mat-raised-button","","color","primary","class","confirm-btn submit-btn",3,"click",4,"ngIf"],["mat-raised-button","","color","warn","class","clear-btn submit-btn",3,"click",4,"ngIf"],["class","prompt-item",3,"disabled","click",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",1,"confirm-btn","submit-btn",3,"click"],["mat-raised-button","","color","warn",1,"clear-btn","submit-btn",3,"click"],[1,"prompt-item",3,"click"],[1,"prompt-details"],["type","checkbox","readonly","",3,"checked","disabled"],[1,"prompt-title"],[1,"prompt-description"]],template:function(e,n){if(e&1){let i=M();r(0,"div",5)(1,"div",6)(2,"div",7)(3,"button",8),C("click",function(){return u(i),g(n.startNewConversation())}),d(4,"+ New Chat"),l(),r(5,"button",9),C("click",function(){return u(i),g(n.sortConversations())}),r(6,"span",10),d(7),l()()(),r(8,"div",11),v(9,We,8,7,"div",12),h(10,"async"),l()(),r(11,"div",13)(12,"div",14)(13,"div",15,0),v(15,Je,11,14,"div",16),h(16,"async"),r(17,"div",17),v(18,et,8,9,"div",18),h(19,"async"),v(20,tt,3,0,"div",19),h(21,"async"),l()()(),r(22,"div",20),v(23,nt,4,2,"div",21)(24,it,3,2,"div",22),r(25,"form",23),C("ngSubmit",function(){return u(i),g(n.sendMessage())}),r(26,"button",24),C("click",function(){return u(i),g(n.togglePromptsPopup())}),r(27,"mat-icon"),d(28,"tune"),l()(),r(29,"textarea",25),H("ngModelChange",function(p){return u(i),K(n.newMessageContent,p)||(n.newMessageContent=p),g(p)}),C("input",function(p){return u(i),g(n.autoResize(p))})("keydown",function(p){return u(i),g(n.onKeyDown(p))}),l(),r(30,"span",26)(31,"button",27),d(32,"Send"),l()(),r(33,"span",26),h(34,"async"),h(35,"async"),r(36,"button",28),h(37,"async"),C("click",function(){return u(i),g(n.onAttachFile())}),r(38,"mat-icon"),d(39,"attach_file"),l()()(),r(40,"span",26),h(41,"async"),h(42,"async"),r(43,"button",28),h(44,"async"),C("click",function(){return u(i),g(n.viewUploadedFiles())}),r(45,"mat-icon"),d(46,"folder"),l()()(),r(47,"input",29,1),C("change",function(p){return u(i),g(n.onFileSelected(p))}),l(),r(49,"input",30,2),C("change",function(p){return u(i),g(n.onFileSelected(p))}),l()()(),v(51,at,8,11,"div",31),l()()}if(e&2){let i;a(7),y(n.sortIcon),a(2),c("ngForOf",_(10,23,n.conversations$)),a(6),c("ngIf",((i=_(16,25,n.selectedPrompts$))!==null&&i!==void 0?i:F(43,D)).length>0),a(3),c("ngForOf",_(19,27,n.messages$)),a(2),c("ngIf",_(21,29,n.isLoading$)),a(3),c("ngIf",n.isUploading),a(),c("ngIf",!n.isUploading&&n.uploadedFileInfos.length>0),a(5),L("ngModel",n.newMessageContent),c("disabled",n.isInputDisabled)("matTooltip",n.isInputDisabled?"The input is disabled when a special instruction is selected.":""),a(),O("disabled-wrapper",n.isSendDisabled),c("matTooltip",n.isSendDisabled?"Please type a message or upload a file and select a prompt.":""),a(),c("disabled",n.isSendDisabled),a(2),O("disabled-wrapper",_(34,31,n.hasDocuments$)),c("matTooltip",_(35,33,n.hasDocuments$)?"Blueprints have already been uploaded. Start a new conversation to upload a new set of files.":"Attach blueprints"),a(3),c("disabled",_(37,35,n.hasDocuments$)),a(4),O("disabled-wrapper",!_(41,37,n.hasDocuments$)),c("matTooltip",_(42,39,n.hasDocuments$)?"":"No files uploaded"),a(3),c("disabled",!_(44,41,n.hasDocuments$)),a(8),c("ngIf",n.isPromptsPopupVisible)}},dependencies:[de,oe,re,se,ae,le,ce,pe,be,ve,ge,he,_e,fe,Ce,Te,ke,Pe,Se,Ie,we,Ae,Fe,xe,Me,ye,Ee],styles:["@keyframes _ngcontent-%COMP%_pulse-text{0%{opacity:.5}50%{opacity:1}to{opacity:.5}}[_nghost-%COMP%]{display:flex;height:100%;width:100%;background-color:#f5f5f5}.full-screen-chat-container[_ngcontent-%COMP%]{display:flex;flex-grow:1}.conversations-list[_ngcontent-%COMP%]{min-width:350px;max-width:350px;border-right:1px solid #ddd;display:flex;flex-direction:column;padding:1rem;background-color:#fff}.conversations-list[_ngcontent-%COMP%]   .conversation-list-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.conversations-list[_ngcontent-%COMP%]   .conversation-list-header[_ngcontent-%COMP%]   .new-chat-btn[_ngcontent-%COMP%]{flex-grow:1}.conversations-list[_ngcontent-%COMP%]   .conversation-list-header[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;padding:0;color:#333;margin-left:.5rem}.conversations-list[_ngcontent-%COMP%]   .conversation-list-header[_ngcontent-%COMP%]   .action-btn[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:24px}.conversations-list[_ngcontent-%COMP%]   .conversation-items[_ngcontent-%COMP%]{overflow-y:auto}.conversations-list[_ngcontent-%COMP%]   .conversation-item[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid #eee;cursor:pointer;transition:background-color .3s;position:relative}.conversations-list[_ngcontent-%COMP%]   .conversation-item.active[_ngcontent-%COMP%]{background-color:#e9f5ff;border-left:3px solid #fbd008}.conversations-list[_ngcontent-%COMP%]   .conversation-item[_ngcontent-%COMP%]:hover{background-color:#f0f0f0}.conversations-list[_ngcontent-%COMP%]   .conversation-item[_ngcontent-%COMP%]   .conversation-title-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.conversations-list[_ngcontent-%COMP%]   .conversation-item[_ngcontent-%COMP%]   .conversation-title[_ngcontent-%COMP%]{font-weight:700;margin:0 0 .25rem;color:#000;flex-grow:1;padding-right:30px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;white-space:normal}.conversations-list[_ngcontent-%COMP%]   .conversation-item[_ngcontent-%COMP%]   .conversation-timestamp[_ngcontent-%COMP%]{font-size:.8rem;color:#6c757d;white-space:nowrap;text-align:right;flex-shrink:0}.conversations-list[_ngcontent-%COMP%]   .conversation-item[_ngcontent-%COMP%]   .conversation-excerpt[_ngcontent-%COMP%]{font-size:.9rem;color:#666;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.edit-icon[_ngcontent-%COMP%]{cursor:pointer;font-size:18px;visibility:hidden;color:#333;position:absolute;right:1rem;top:1rem;background-color:#fff;border-radius:50%;padding:4px;display:flex;align-items:center;justify-content:center;width:26px;height:26px;box-shadow:0 1px 3px #0000001a}.edit-icon[_ngcontent-%COMP%]:hover{color:#000}.conversation-item[_ngcontent-%COMP%]:hover   .edit-icon[_ngcontent-%COMP%]{visibility:visible}.edit-container[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%}.edit-container[_ngcontent-%COMP%]   .edit-input[_ngcontent-%COMP%]{flex-grow:1;padding:4px 8px;border:1px solid #ccc;border-radius:4px}.edit-container[_ngcontent-%COMP%]   .edit-actions[_ngcontent-%COMP%]{display:flex;align-items:center}.edit-container[_ngcontent-%COMP%]   .edit-actions[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]{color:green}.edit-container[_ngcontent-%COMP%]   .edit-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{color:red}.edit-container[_ngcontent-%COMP%]   .edit-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:4px;border:none;background-color:transparent}.chat-area[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column;background-color:#fafafa;overflow:visible;position:relative}.chat-area[_ngcontent-%COMP%]   .scroll-wrapper[_ngcontent-%COMP%]{flex:1;position:relative}.chat-area[_ngcontent-%COMP%]   .chat-window-container[_ngcontent-%COMP%]{position:absolute;inset:0;overflow-y:auto}.chat-area[_ngcontent-%COMP%]   .message-history[_ngcontent-%COMP%]{padding:1rem;display:flex;flex-direction:column}.chat-area[_ngcontent-%COMP%]   .message-history[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{display:flex;align-items:flex-start;padding:.5rem 1rem;border-radius:15px;margin-bottom:.5rem;max-width:70%}.chat-area[_ngcontent-%COMP%]   .message-history[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .chat-icon[_ngcontent-%COMP%]{margin-right:1rem;margin-top:.2rem;flex-shrink:0;background-color:#fbd008;border-radius:15px}.chat-area[_ngcontent-%COMP%]   .message-history[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{flex-grow:1}.chat-area[_ngcontent-%COMP%]   .message-history[_ngcontent-%COMP%]   .message.user[_ngcontent-%COMP%]{background-color:#fbd008;color:#fff;align-self:flex-end;border-bottom-right-radius:3px}.chat-area[_ngcontent-%COMP%]   .message-history[_ngcontent-%COMP%]   .message.ai[_ngcontent-%COMP%]{background-color:#e9ecef;color:#333;align-self:flex-start;border-bottom-left-radius:3px}.chat-area[_ngcontent-%COMP%]   .message-history[_ngcontent-%COMP%]   .message.ai[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse-text 1.5s infinite}.chat-area[_ngcontent-%COMP%]   .message-history[_ngcontent-%COMP%]   .user-prompt[_ngcontent-%COMP%]{color:#000;white-space:pre-wrap}.chat-area[_ngcontent-%COMP%]   .message-input-container[_ngcontent-%COMP%]{padding:1rem;border-top:1px solid rgb(255,255,255);background-color:#fff;position:relative}.chat-area[_ngcontent-%COMP%]   .message-input-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex}.chat-area[_ngcontent-%COMP%]   .message-input-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .chat-area[_ngcontent-%COMP%]   .message-input-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{flex-grow:1;padding:.75rem;border:1px solid #ccc;border-radius:20px;margin-right:.5rem;resize:none;overflow-y:hidden}.chat-area[_ngcontent-%COMP%]   .message-input-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:disabled{cursor:not-allowed}.chat-area[_ngcontent-%COMP%]   .message-input-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{gap:.5rem;margin-right:.1rem}.chat-area[_ngcontent-%COMP%]   .upload-progress[_ngcontent-%COMP%]{margin-bottom:1rem}.chat-area[_ngcontent-%COMP%]   .upload-progress[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:.9rem;color:#333}.chat-area[_ngcontent-%COMP%]   .upload-complete[_ngcontent-%COMP%]{margin-bottom:1rem}.chat-area[_ngcontent-%COMP%]   .upload-complete[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.9rem;color:#28a745;cursor:default}.chat-area[_ngcontent-%COMP%]   .welcome-screen[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100%;text-align:center}.chat-area[_ngcontent-%COMP%]   .welcome-screen[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem;margin-bottom:1rem}.chat-area[_ngcontent-%COMP%]   .welcome-screen[_ngcontent-%COMP%]   .prompt-selection[_ngcontent-%COMP%]{width:100%;max-width:1400px;margin-top:2rem}.chat-area[_ngcontent-%COMP%]   .welcome-screen[_ngcontent-%COMP%]   .prompt-selection[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#000}.chat-area[_ngcontent-%COMP%]   .welcome-screen[_ngcontent-%COMP%]   .prompt-selection[_ngcontent-%COMP%]   .prompt-buttons[_ngcontent-%COMP%]{display:flex;gap:1rem;flex-wrap:wrap;justify-content:center;margin-top:1rem}.chat-area[_ngcontent-%COMP%]   .welcome-screen[_ngcontent-%COMP%]   .prompt-selection[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;text-align:center;height:5rem;width:12rem;padding:.5rem;white-space:normal;word-wrap:break-word}.submit-btn[_ngcontent-%COMP%]{background:#fbd008;border-radius:10px;padding:8px 16px;font-weight:500;color:#333;margin:0 .5rem;border:none}.submit-btn[_ngcontent-%COMP%]:hover{background:#e6bf00}.submit-btn.publish-btn[_ngcontent-%COMP%]{background:#fbd008}.submit-btn.publish-btn[_ngcontent-%COMP%]:hover{background:#e6bf00}.submit-btn.save-btn[_ngcontent-%COMP%]{background:#fcd02d}.submit-btn.save-btn[_ngcontent-%COMP%]:hover{background:#f3c003}.send-button[disabled][_ngcontent-%COMP%]{background-color:#ccc;cursor:not-allowed}.more-options-btn[_ngcontent-%COMP%]{background:transparent;border:none;color:#333;font-size:1.5rem;padding:0 .5rem;align-self:center;cursor:pointer}.more-options-btn[_ngcontent-%COMP%]:hover{color:#fbd008}.prompts-popup[_ngcontent-%COMP%]{position:absolute;bottom:80px;left:1rem;background-color:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 2px 10px #0000001a;padding:1rem;z-index:100;width:calc(100% - 2rem);max-height:300px;overflow-y:auto}.prompts-popup[_ngcontent-%COMP%]   .prompt-item[_ngcontent-%COMP%]{padding:.75rem;border-bottom:1px solid #eee;cursor:pointer;transition:background-color .3s}.prompts-popup[_ngcontent-%COMP%]   .prompt-item[_ngcontent-%COMP%]:hover{background-color:#f0f0f0}.prompts-popup[_ngcontent-%COMP%]   .prompt-item[_ngcontent-%COMP%]   .prompt-title[_ngcontent-%COMP%]{font-weight:700;color:#333}.prompts-popup[_ngcontent-%COMP%]   .prompt-item[_ngcontent-%COMP%]   .prompt-description[_ngcontent-%COMP%]{font-size:.9rem;color:#666;margin-top:.25rem}.selected-prompt-display[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:0;z-index:2;background-color:#f0f4f8;padding:1rem;margin:1rem;border-radius:8px;border:1px solid #d1dce5}.selected-prompt-display[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0;font-size:1.1rem;font-weight:600;color:#333}.selected-prompt-display[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style-type:none;padding:0;margin:0}.selected-prompt-display[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:.5rem;font-size:.9rem;color:#555}.button-wrapper[_ngcontent-%COMP%]{display:inline-block}.disabled-wrapper[_ngcontent-%COMP%]{cursor:not-allowed}.disabled-wrapper[_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%]{background-color:#ccc;color:#666;pointer-events:none}.icon-button[_ngcontent-%COMP%]{min-width:0;padding:0;width:40px;height:40px;display:flex;align-items:center;justify-content:center}.icon-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin:0 auto 0 11px}"]})};var Rt=[{path:"",redirectTo:"new",pathMatch:"full"},{path:"new",component:A,canActivate:[W]},{path:":conversationId",component:A,canActivate:[W]}];export{Rt as AI_CHAT_ROUTES};
