<div class="connections-container">
  <h1>User Directory</h1>

  <mat-card>
    <mat-card-content>
      <mat-form-field appearance="fill">
        <mat-label>Search for users</mat-label>
        <input matInput [(ngModel)]="searchTerm" (keyup.enter)="searchUsers()" placeholder="e.g., John Doe, Electrician">
        <button mat-icon-button matSuffix (click)="searchUsers()">
          <mat-icon>search</mat-icon>
        </button>
      </mat-form-field>
    </mat-card-content>
  </mat-card>

  <mat-tab-group>
    <mat-tab label="Search Results">
      <ng-template matTabContent>
        <mat-list>
          <mat-list-item *ngFor="let user of searchResults">
            <h3 matLine>{{ user.firstName }} {{ user.lastName }}</h3>
            <p matLine>{{ user.userType }}</p>
            <button mat-stroked-button color="primary" (click)="sendConnectionRequest(user.id)">
              <mat-icon>person_add</mat-icon>
              Connect
            </button>
          </mat-list-item>
        </mat-list>
        <p *ngIf="searchResults.length === 0">No users found.</p>
      </ng-template>
    </mat-tab>

    <mat-tab label="My Connections">
      <ng-template matTabContent>
        <mat-list>
          <mat-list-item *ngFor="let conn of connections">
            <h3 matLine>{{ conn.requester?.firstName }} {{ conn.requester?.lastName }}</h3>
            <p matLine>Connected</p>
          </mat-list-item>
        </mat-list>
      </ng-template>
    </mat-tab>

    <mat-tab label="Incoming Requests">
      <ng-template matTabContent>
        <mat-list>
          <mat-list-item *ngFor="let req of incomingRequests">
            <h3 matLine>{{ req.requester?.firstName }} {{ req.requester?.lastName }}</h3>
            <p matLine>Wants to connect with you.</p>
            <button mat-stroked-button color="primary" (click)="acceptConnectionRequest(req.id)">Accept</button>
            <button mat-stroked-button color="warn" (click)="declineConnectionRequest(req.id)">Decline</button>
          </mat-list-item>
        </mat-list>
      </ng-template>
    </mat-tab>

    <mat-tab label="Outgoing Requests">
      <ng-template matTabContent>
        <mat-list>
          <mat-list-item *ngFor="let req of outgoingRequests">
            <h3 matLine>{{ req.receiver?.firstName }} {{ req.receiver?.lastName }}</h3>
            <p matLine>Request sent</p>
          </mat-list-item>
        </mat-list>
      </ng-template>
    </mat-tab>
  </mat-tab-group>
</div>

