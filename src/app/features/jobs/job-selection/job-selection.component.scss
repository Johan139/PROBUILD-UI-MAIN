@use 'styles/util/mixins' as u;

:host {
  display: block;
  background: transparent;
  color: var(--color-text);
}

/* Container */
.container {
  box-sizing: border-box;
  width: min(1200px, 80vw);
  min-height: calc(100vh - 65px);
  margin: 0 auto;
  padding: var(--space-5);
  display: flex;
  justify-content: center;
}

/* Full column card */
.fullcolumn {
  width: 100%;
  background: var(--color-surface);
  border: 1px solid color-mix(in oklab, var(--color-accent) 60%, var(--color-border));
  border-radius: var(--radius-lg);
  padding: var(--space-4);
  box-shadow: var(--shadow-1);
}

/* Cards */
mat-card {
  background: var(--color-surface);
  border-radius: var(--radius-md);
  border: 1px solid var(--color-border);
  box-shadow: var(--shadow-1);
  padding: var(--space-5);
  margin-bottom: var(--space-4);
}
mat-card-title {
  font: var(--fw-extrabold) var(--fs-lg)/var(--lh-tight) var(--font-sans);
  color: var(--color-text);
  letter-spacing: .02em;
  margin-bottom: var(--space-3);
}
mat-divider {
  height: 3px;
  border-radius: 999px;
  background: var(--color-accent);
  opacity: .9;
  margin: var(--space-4) 0;
}

/* Inline error */
.error-message {
  text-align: center;
  padding: var(--space-3);
  background: color-mix(in oklab, var(--color-danger) 12%, white);
  color: color-mix(in oklab, var(--color-danger) 85%, black);
  border: 1px solid color-mix(in oklab, var(--color-danger) 55%, var(--color-border));
  border-radius: var(--radius-md);
  margin-bottom: var(--space-3);

  p { margin: 0; font-size: 1rem; }
}

/* Tables & Scroll Areas */

.table-wrapper {
  width: 100%;
  max-height: 320px;
  overflow: auto;
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  background: var(--color-surface);
}


table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  min-width: 640px;

  thead th {
    position: sticky; top: 0; z-index: 2;
    background: var(--color-surface-subtle);
    color: var(--color-text);
    text-transform: uppercase;
    font-weight: var(--fw-semibold);
    padding: 12px 10px;
    border-bottom: 1px solid var(--color-border);
    white-space: nowrap;
    vertical-align: middle;
  }

  tbody td {
    padding: 12px 10px;
    color: var(--color-text);
    border-top: 1px solid var(--color-border);
    vertical-align: middle;
  }

  tbody tr:hover td { background: var(--color-surface-hover); }
  tbody tr:nth-child(even) td { background: var(--color-surface-subtle); }

  .mat-column-actions { width: 100px; text-align: center; }
  .mat-checkbox { margin: 0 auto; }

  .data-row.selected td {
    background: color-mix(in oklab, var(--color-primary) 12%, transparent);
    font-weight: var(--fw-semibold);
  }
}

/* Alternate themed-table */
.themed-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;

  th {
    background: var(--color-surface-subtle);
    color: var(--color-text);
    font-weight: var(--fw-semibold);
    padding: 10px 12px;
    border-bottom: 1px solid var(--color-border);
    text-align: left;
  }
  td {
    padding: 10px 12px;
    border-top: 1px solid var(--color-border);
  }
  tr:hover td { background: var(--color-surface-hover); }
  tr.deleted td { background: color-mix(in oklab, var(--color-danger) 12%, transparent); }
}

/* Job details */
.job-details-container { margin-top: var(--space-6); width: 100%; }
.job-details {
  padding: var(--space-3) 0;
  p { color: var(--color-text); margin: .25rem 0; }
}

/* Subtasks area */
.subtask-section {
  padding: var(--space-3) 0;
  max-height: 50vh;
  overflow: auto;
}
.subtask-table .table-header {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: var(--space-3);

  h3 { color: var(--color-text); font-size: 1.1rem; font-weight: var(--fw-bold); }
}

/* Buttons & CTAs */

.submit-btn,
.view-btn,
button[mat-raised-button],
button.mat-mdc-raised-button,
button.btn {
  background: var(--color-primary) !important;
  color: var(--color-text-inverse) !important;
  border-radius: var(--radius-md);
  padding: 10px 16px;
  font-weight: var(--fw-semibold);
  border: 1px solid transparent;
  min-width: 120px;
  box-shadow: 0 2px 4px rgba(0,0,0,.08);
  transition: background-color .2s ease, box-shadow .2s ease, transform .02s ease;
  @include u.interactive-states;

  &:hover { background: var(--color-primary-hover); box-shadow: 0 3px 6px rgba(0,0,0,.12); }
  &:disabled { opacity: .6; cursor: not-allowed; box-shadow: none; }
}

/* Variants */
.submit-btn.quote-btn { background: var(--color-accent); color: var(--color-text-inverse); }
.submit-btn.save-btn  { background: var(--color-primary); color: var(--color-text-inverse); }

button[mat-raised-button]:hover { background: var(--color-primary-hover); box-shadow: 0 3px 6px rgba(0,0,0,.15); }

.action-buttons {
  display: flex; gap: var(--space-3); padding: var(--space-3) 0; justify-content: flex-start;
}

/* Icon buttons */
button[mat-icon-button],
button.icon-btn {
  color: var(--color-text);
  border-radius: var(--radius-sm);
  @include u.interactive-states;

  &:hover { background: color-mix(in oklab, var(--color-accent) 16%, transparent); color: var(--color-accent); }
  &:focus-visible { outline: 0; box-shadow: 0 0 0 2px color-mix(in oklab, var(--color-primary) 60%, transparent); }
}
button.icon-btn mat-icon { font-size: 18px; width: 18px; height: 18px; }

/* Documents */

.documents-dialog { padding: var(--space-4); }
.documents-dialog h2[mat-dialog-title] {
  font: var(--fw-extrabold) var(--fs-lg)/var(--lh-tight) var(--font-sans);
  color: var(--color-text);
  margin-bottom: var(--space-3);
}

.no-documents, .no-subtasks {
  text-align: center; padding: var(--space-4); color: var(--color-text);
  p { margin: 0; font-size: 1rem; }
  &[error] { color: var(--color-danger); font-weight: var(--fw-semibold); }
}

.loading-container {
  padding: var(--space-6);
  display: grid; place-items: center;
  gap: var(--space-3);
  color: var(--color-text);
}

.loading-documents { text-align: center; padding: var(--space-3); color: var(--color-text); }

.documents-list {
  max-height: 60vh; overflow: auto; padding-right: .5rem;
}

.document-item {
  display: flex; align-items: center; justify-content: space-between;
  padding: .75rem; margin-bottom: .5rem;
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  background: var(--color-surface);
  transition: all .2s ease;

  &:hover { background: var(--color-surface-subtle); border-color: var(--color-accent); box-shadow: var(--shadow-1); }
}
.document-info { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
.document-name {
  font-size: 1rem; font-weight: var(--fw-semibold); color: var(--color-text);
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-bottom: .25rem;
}
.document-meta { font-size: .85rem; color: var(--color-text); opacity: .85; }

/* Reports */

.report-dialog { padding: var(--space-5); }
.report-dialog .report-content { max-height: 85vh; overflow: auto; padding-right: 1rem; }
.report-dialog .report-list { display: flex; flex-direction: column; gap: var(--space-4); }
.report-dialog .report-item {
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  padding: var(--space-4);
  background: var(--color-surface);
  box-shadow: var(--shadow-1);
}
.report-section { margin-bottom: var(--space-4); }
.report-section-title {
  font-size: 1.15rem; font-weight: var(--fw-bold); color: var(--color-text);
  margin-bottom: .75rem;
  border-bottom: 2px solid var(--color-accent);
  padding-bottom: .25rem;
}
.report-text p { margin: .5rem 0; color: var(--color-text); line-height: 1.6; }
.report-list-items ul { list-style: disc; padding-left: 1.25rem; margin: .5rem 0; }
.report-list-items li { color: var(--color-text); margin-bottom: .25rem; line-height: 1.5; }

.report-table .themed-table th,
.report-table .themed-table td { padding: 10px; word-wrap: break-word; }

/* Big BOM dialog override */
.cdk-overlay-pane.bill-of-materials-dialog {
  max-width: none !important;
  width: 1800px !important;
}

/* Alerts */

.alert-overlay {
  position: fixed; inset: 0;
  background: rgba(0,0,0,.5); backdrop-filter: blur(5px);
  display: grid; place-items: center; z-index: 1000;
}
.alert-modal {
  width: 320px;
  background: var(--color-surface);
  color: var(--color-text);
  padding: var(--space-5);
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-3);
  text-align: center;

  p { margin-bottom: var(--space-4); }
}

.is-compact {
  --space-5: 16px;
  .table-wrapper { max-height: 260px; }
  thead th, tbody td { padding: 8px 10px !important; }
  .submit-btn, .btn, button[mat-raised-button] { padding: 8px 12px; min-width: 104px; }
}

/* Responsive */
@media (max-width: 768px) {
  .container { width: 95vw; padding: var(--space-4); }
  .action-buttons { flex-direction: column; }
  .submit-btn { width: 100%; margin: .5rem 0; }
  .document-item { flex-direction: column; align-items: flex-start; padding: .5rem; }
  .document-info { margin-bottom: .5rem; }
  .view-btn { margin-left: 0; width: 100%; text-align: center; }
  .report-dialog { padding: var(--space-4); }
  .report-section-title { font-size: 1rem; }
  .report-text p, .report-list-items li { font-size: .95rem; }
  .report-table .themed-table th, .report-table .themed-table td { font-size: .9rem; padding: 6px; }
  .cdk-overlay-pane.bill-of-materials-dialog { width: 95vw !important; max-width: none !important; }
}

/* Print */
@media print {
  .container { width: 100% !important; margin: 0; padding: 10mm; }
  button, .btn, .btn-link, .remove-logo { display: none !important; }
  .table-wrapper, .documents-list, .report-dialog .report-content { overflow: visible !important; max-height: none !important; }
}
