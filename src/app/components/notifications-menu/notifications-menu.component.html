<button mat-icon-button
        class="notification-button"
        (click)="toggleMenu()"
        aria-label="Open notifications">
  <mat-icon>notifications</mat-icon>
  <span *ngIf="hasUnreadNotifications$ | async" class="notification-dot"></span>
</button>

<div class="notif-menu" *ngIf="isOpen" (click)="$event.stopPropagation()">
  <ng-container *ngIf="(recentNotifications$ | async) as notifications">
    <!-- Empty state -->
    <div class="notif-empty" *ngIf="!notifications?.length">
      <mat-icon>notifications_none</mat-icon>
      <p>No recent notifications</p>
    </div>

    <!-- List -->
    <div class="notif-list" *ngIf="notifications?.length">
      <button class="notif-item"
              *ngFor="let n of notifications | slice:0:8; trackBy: trackByNotif"
              (click)="navigateToJob(n)">
        <div class="avatar">
          <span class="avatar__text">{{ getInitials(n.senderFullName) }}</span>
        </div>
        <div class="notif-content">
          <div class="notif-header">
            <span class="sender">{{ n.senderFullName }}</span>
            <span class="time">{{ n.timestamp | date:'shortTime' }}</span>
          </div>
          <div class="notif-body">
            <div class="project">{{ n.projectName }}</div>
            <div class="message">{{ n.message }}</div>
          </div>
        </div>
      </button>
    </div>
  </ng-container>

  <div class="notif-divider"></div>

  <div class="notif-actions">
    <button class="linklike" (click)="goToAllNotifications()">
      Show all notifications
    </button>
    <button class="linklike" (click)="markAllRead()">
      Mark all read
    </button>
  </div>
</div>

<div class="notif-backdrop" *ngIf="isOpen" (click)="closeMenu()"></div>
